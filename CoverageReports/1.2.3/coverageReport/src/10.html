<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Development\SolutionInspector\src\SolutionInspector.Api\Configuration\ConfigurationElementCollectionBase.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Collections.Generic;
using System.Configuration;
using System.Xml;
using Fasterflect;

namespace SolutionInspector.Api.Configuration
{
  /// &lt;summary&gt;
  ///   Base class for configuration element collections with elements of type &lt;typeparamref name=&quot;TElement&quot; /&gt;.
  /// &lt;/summary&gt;
  public abstract class ConfigurationElementCollectionBase&lt;TElement&gt; : ConfigurationElementCollection, IConfigurationCollection&lt;TElement&gt;
    where TElement : ConfigurationElement, new()

  {
    /// &lt;inheritdoc /&gt;
    protected abstract override string ElementName { get; }

    /// &lt;inheritdoc /&gt;
    public override ConfigurationElementCollectionType CollectionType =&gt; ConfigurationElementCollectionType.BasicMap;

    /// &lt;summary&gt;
    ///   Adds the given &lt;paramref name=&quot;element&quot; /&gt; to the collection.
    /// &lt;/summary&gt;
    public void Add (TElement element)
    {
      BaseAdd(element);
    }

    /// &lt;inheritdoc /&gt;
    public void Clear ()
    {
      BaseClear();
    }

    /// &lt;inheritdoc /&gt;
    public bool Contains (TElement item)
    {
      return BaseIndexOf(item) != -1;
    }

    /// &lt;inheritdoc /&gt;
    public void Remove (TElement item)
    {
      BaseRemove(GetElementKey(item));
    }

    /// &lt;inheritdoc /&gt;
    public new IEnumerator&lt;TElement&gt; GetEnumerator ()
    {
      var enumerator = base.GetEnumerator();

      while (enumerator.MoveNext())
        yield return (TElement) enumerator.Current;
    }

    /// &lt;inheritdoc /&gt;
    protected sealed override ConfigurationElement CreateNewElement ()
    {
      return new TElement();
    }

    /// &lt;inheritdoc /&gt;
    protected override bool IsElementName (string elementName)
    {
      return !string.IsNullOrWhiteSpace(elementName) &amp;&amp; elementName == ElementName;
    }

    /// &lt;inheritdoc /&gt;
    protected override object GetElementKey (ConfigurationElement element)
    {
      return element;
    }

    /// &lt;inheritdoc /&gt;
    protected override bool OnDeserializeUnrecognizedElement (string elementName, XmlReader reader)
    {
      if (!IsElementName(elementName))
        return false;

      var element = CreateNewElement();
      element.CallMethod(&quot;DeserializeElement&quot;, reader, false);
      BaseAdd(element);
      return true;
    }
  }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[19,74,19,117,1],[26,7,26,24,1],[32,7,32,19,1],[38,7,38,38,1],[44,7,44,39,1],[50,7,50,45,1],[52,7,52,36,1],[53,9,53,52,1],[54,5,54,6,1],[59,7,59,29,1],[65,7,65,84,1],[71,7,71,22,1],[77,7,77,39,1],[78,9,78,22,1],[80,7,80,40,1],[81,7,81,63,1],[82,7,82,24,1],[83,7,83,19,1]]);
    </script>
  </body>
</html>