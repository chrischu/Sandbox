<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Development\SolutionInspector\src\SolutionInspector.Configuration\CommaSeparatedStringCollection.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.Collections.Generic;
using System.Diagnostics.CodeAnalysis;
using System.Linq;
using JetBrains.Annotations;
using SolutionInspector.Commons.Extensions;

namespace SolutionInspector.Configuration
{
  /// &lt;summary&gt;
  ///   A collection that can be used in configurations and that is serialized as a comma-separated string.
  /// &lt;/summary&gt;
  public class CommaSeparatedStringCollection : ConfigurationValue&lt;CommaSeparatedStringCollection&gt;, IList&lt;string&gt;
  {
    private List&lt;string&gt; _collection = new List&lt;string&gt;();

    /// &lt;summary&gt;
    ///   Constructs a new &lt;see cref=&quot;CommaSeparatedStringCollection&quot; /&gt; without any elements.
    /// &lt;/summary&gt;
    public CommaSeparatedStringCollection (Action&lt;string&gt; updateAction)
      : base(updateAction)
    {
    }

    /// &lt;summary&gt;
    ///   Constructs a new &lt;see cref=&quot;CommaSeparatedStringCollection&quot; /&gt; without the given &lt;paramref name=&quot;elements&quot; /&gt;.
    /// &lt;/summary&gt;
    public CommaSeparatedStringCollection (Action&lt;string&gt; updateAction, IEnumerable&lt;string&gt; elements)
      : base(updateAction)
    {
      AddRange(elements);
    }

    /// &lt;inheritdoc /&gt;
    public int Count =&gt; _collection.Count;

    /// &lt;inheritdoc /&gt;
    public string this [int index]
    {
      get =&gt; _collection[index];
      set
      {
        _collection[index] = value;
        Update();
      }
    }

    /// &lt;summary&gt;
    ///   Serializes the elements of the collection as comma-separated string.
    /// &lt;/summary&gt;
    public override string Serialize ()
    {
      return _collection.Join(&quot;,&quot;);
    }

    /// &lt;summary&gt;
    ///   Deserializes the given &lt;paramref name=&quot;serialized&quot; /&gt; string and replaces the elements in the collection with the ones from the string.
    /// &lt;/summary&gt;
    public override void Deserialize (string serialized)
    {
      var collection = string.IsNullOrEmpty(serialized) ? Enumerable.Empty&lt;string&gt;() : serialized.Split(&#39;,&#39;);
      _collection = new List&lt;string&gt;(collection);
      Update();
    }

    /// &lt;inheritdoc /&gt;
    public IEnumerator&lt;string&gt; GetEnumerator ()
    {
      return _collection.GetEnumerator();
    }

    /// &lt;inheritdoc /&gt;
    public void Add ([CanBeNull] string item)
    {
      AddRange(new[] { item });
    }

    /// &lt;inheritdoc /&gt;
    public void Insert (int index, [CanBeNull] string item)
    {
      _collection.Insert(index, item);
    }

    /// &lt;summary&gt;
    ///   Adds all given &lt;paramref name=&quot;items&quot; /&gt; to the collection.
    /// &lt;/summary&gt;
    public void Add (params string[] items)
    {
      AddRange(items);
    }

    /// &lt;summary&gt;
    ///   Adds all given &lt;paramref name=&quot;items&quot; /&gt; to the collection.
    /// &lt;/summary&gt;
    public void AddRange (IEnumerable&lt;string&gt; items)
    {
      _collection.AddRange(items);
      Update();
    }

    /// &lt;inheritdoc /&gt;
    public void Clear ()
    {
      _collection.Clear();
      Update();
    }

    /// &lt;inheritdoc /&gt;
    public bool Contains ([CanBeNull] string item)
    {
      return _collection.Contains(item);
    }

    /// &lt;inheritdoc /&gt;
    public bool Remove ([CanBeNull] string item)
    {
      var removed = _collection.Remove(item);
      if (removed)
        Update();
      return removed;
    }

    /// &lt;inheritdoc /&gt;
    public void RemoveAt (int index)
    {
      _collection.RemoveAt(index);
    }

    /// &lt;inheritdoc /&gt;
    IEnumerator IEnumerable.GetEnumerator ()
    {
      return GetEnumerator();
    }

    /// &lt;inheritdoc /&gt;
    public void CopyTo(string[] array, int arrayIndex)
    {
      _collection.CopyTo(array, arrayIndex);
    }

    /// &lt;inheritdoc /&gt;
    [ExcludeFromCodeCoverage]
    public bool IsReadOnly =&gt; false;

    /// &lt;inheritdoc /&gt;
    public int IndexOf([CanBeNull] string item)
    {
      return _collection.IndexOf(item);
    }
  }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[16,5,16,59,1],[16,5,16,59,1],[22,9,22,27,1],[30,9,30,27,1],[32,7,32,26,1],[36,25,36,42,1],[41,14,41,32,1],[44,9,44,36,1],[45,9,45,18,1],[54,7,54,36,1],[62,7,62,110,1],[63,7,63,50,1],[64,7,64,16,1],[70,7,70,42,1],[76,7,76,32,1],[82,7,82,39,1],[90,7,90,23,1],[98,7,98,35,1],[99,7,99,16,1],[105,7,105,27,1],[106,7,106,16,1],[112,7,112,41,1],[118,7,118,46,1],[119,7,119,19,1],[120,9,120,18,1],[121,7,121,22,1],[127,7,127,35,1],[133,7,133,30,1],[139,7,139,45,1],[149,7,149,40,1]]);
    </script>
  </body>
</html>