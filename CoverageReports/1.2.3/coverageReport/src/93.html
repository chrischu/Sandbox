<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Development\SolutionInspector\src\SolutionInspector.Commons\Extensions\XmlExtensions.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Linq;
using System.Xml;

namespace SolutionInspector.Commons.Extensions
{
  /// &lt;summary&gt;
  ///   Extension methods for XML classes.
  /// &lt;/summary&gt;
  public static class XmlExtensions
  {
    /// &lt;summary&gt;
    ///   Adds an attribute with the given &lt;paramref name=&quot;name&quot; /&gt; and &lt;paramref name=&quot;value&quot; /&gt; to the &lt;paramref name=&quot;element&quot; /&gt;.
    /// &lt;/summary&gt;
    public static void AddAttribute (this XmlElement element, string name, string value)
    {
      var attr = element.OwnerDocument.AssertNotNull().CreateAttribute(name);
      attr.Value = value;
      element.Attributes.Append(attr);
    }

    /// &lt;summary&gt;
    ///   Adds an element with the given &lt;paramref name=&quot;name&quot; /&gt; and &lt;paramref name=&quot;value&quot; /&gt; to the &lt;paramref name=&quot;element&quot; /&gt;.
    /// &lt;/summary&gt;
    public static void AddElement (this XmlElement element, string name, string value)
    {
      var elem = element.OwnerDocument.AssertNotNull().CreateElement(name);
      elem.InnerText = value;
      element.AppendChild(elem);
    }

    /// &lt;summary&gt;
    ///   Removes all children from the &lt;paramref name=&quot;xmlNode&quot; /&gt;.
    /// &lt;/summary&gt;
    public static void RemoveAllChildren (this XmlNode xmlNode)
    {
      var child = xmlNode.FirstChild;

      while (child != null)
      {
        var sibling = child.NextSibling;
        xmlNode.RemoveChild(child);
        child = sibling;
      }
    }

    /// &lt;summary&gt;
    ///   Removes all attributes that match the &lt;paramref name=&quot;filter&quot; /&gt; from the &lt;paramref name=&quot;xmlNode&quot; /&gt;.
    /// &lt;/summary&gt;
    public static void RemoveAttributesWhere (this XmlNode xmlNode, Func&lt;XmlAttribute, bool&gt; filter)
    {
      if (xmlNode.Attributes == null || xmlNode.Attributes.Count == 0)
        return;

      var toRemove = xmlNode.Attributes.Cast&lt;XmlAttribute&gt;().Where(filter).ToArray();

      foreach (var attribute in toRemove)
        xmlNode.Attributes.Remove(attribute);
    }
  }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[17,7,17,78,1],[18,7,18,26,1],[19,7,19,39,1],[27,7,27,76,1],[28,7,28,30,1],[29,7,29,33,1],[37,7,37,38,1],[39,7,39,28,1],[41,9,41,41,1],[42,9,42,36,1],[43,9,43,25,1],[52,7,52,71,1],[53,9,53,16,1],[55,7,55,86,1],[57,16,57,29,1],[57,30,57,32,1],[57,33,57,41,1],[58,9,58,46,1]]);
    </script>
  </body>
</html>