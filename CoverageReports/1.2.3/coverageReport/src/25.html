<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Development\SolutionInspector\src\SolutionInspector.Configuration\ConfigurationManager.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using Wrapperator.Interfaces.Xml.Linq;

namespace SolutionInspector.Configuration
{
  /// &lt;summary&gt;
  ///   Provides methods to load &lt;see cref=&quot;ConfigurationDocument&quot; /&gt;s.
  /// &lt;/summary&gt;
  public interface IConfigurationManager
  {
    /// &lt;summary&gt;
    ///   Loads and validates the &lt;see cref=&quot;ConfigurationDocument&quot; /&gt; of type &lt;typeparamref name=&quot;T&quot; /&gt; from the given
    ///   &lt;paramref name=&quot;configurationFilePath&quot; /&gt;.
    /// &lt;/summary&gt;
    T LoadDocument&lt;T&gt; (string configurationFilePath)
      where T : ConfigurationDocument, new();
  }

  /// &lt;summary&gt;
  ///   Default implementation of &lt;see cref=&quot;IConfigurationManager&quot; /&gt;.
  /// &lt;/summary&gt;
  public class ConfigurationManager : IConfigurationManager
  {
    private readonly IXDocumentStatic _xDocumentStatic;

    /// &lt;summary&gt;
    ///   Creates a new &lt;see cref=&quot;ConfigurationManager&quot; /&gt;.
    /// &lt;/summary&gt;
    public ConfigurationManager (IXDocumentStatic xDocumentStatic)
    {
      _xDocumentStatic = xDocumentStatic;
    }

    /// &lt;inheritdoc /&gt;
    public T LoadDocument&lt;T&gt; (string configurationFilePath)
      where T : ConfigurationDocument, new()
    {
      var xDocument = _xDocumentStatic.Load(configurationFilePath);

      return ConfigurationDocument.Load&lt;T&gt;(configurationFilePath, xDocument._XDocument);
    }
  }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[28,5,28,67,1],[30,7,30,42,1],[37,7,37,68,1],[39,7,39,89,1]]);
    </script>
  </body>
</html>