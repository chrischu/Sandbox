<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Development\SolutionInspector\src\SolutionInspector.Commons\Extensions\EnumerableExtensions.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading;
using JetBrains.Annotations;

namespace SolutionInspector.Commons.Extensions
{
  /// &lt;summary&gt;
  ///   Extension methods for &lt;see cref=&quot;IEnumerable{T}&quot; /&gt;.
  /// &lt;/summary&gt;
  public static class EnumerableExtensions
  {
    /// &lt;summary&gt;
    ///   Checks if the given &lt;paramref name=&quot;enumerable&quot; /&gt; contains more than one elements.
    /// &lt;/summary&gt;
    public static bool ContainsMoreThanOne&lt;T&gt; (this IEnumerable&lt;T&gt; enumerable)
    {
      return enumerable.ContainsMoreThan(1);
    }

    /// &lt;summary&gt;
    ///   Checks if the given &lt;paramref name=&quot;enumerable&quot; /&gt; contains more than &lt;paramref name=&quot;count&quot; /&gt; elements.
    /// &lt;/summary&gt;
    private static bool ContainsMoreThan&lt;T&gt; (this IEnumerable&lt;T&gt; enumerable, int count)
    {
      return enumerable.Skip(count).Any();
    }

    /// &lt;summary&gt;
    ///   Executes &lt;paramref name=&quot;action&quot; /&gt; for every element in &lt;paramref name=&quot;source&quot; /&gt;.
    /// &lt;/summary&gt;
    public static void ForEach&lt;T&gt; (this IEnumerable&lt;T&gt; source, Action&lt;T&gt; action)
    {
      foreach (var item in source)
        action(item);
    }

    /// &lt;summary&gt;
    ///   Joins all the string in the &lt;paramref name=&quot;source&quot; /&gt; with the given &lt;paramref name=&quot;separator&quot; /&gt;.
    /// &lt;/summary&gt;
    public static string Join (this IEnumerable&lt;string&gt; source, string separator)
    {
      return string.Join(separator, source);
    }

    /// &lt;summary&gt;
    ///   Stringifies the &lt;paramref name=&quot;source&quot; /&gt; by converting every element to a string with &lt;paramref name=&quot;converter&quot; /&gt; and then joining them with
    ///   a the &lt;paramref name=&quot;separator&quot; /&gt;.
    /// &lt;/summary&gt;
    public static string ConvertAndJoin&lt;TSource&gt; (this IEnumerable&lt;TSource&gt; source, Func&lt;TSource, object&gt; converter = null, string separator = &quot;&quot;)
    {
      converter = converter ?? (x =&gt; x);
      return source.Select(x =&gt; converter(x).ToString()).Join(separator);
    }

    private static readonly ThreadLocal&lt;int&gt; s_indentLevel = new ThreadLocal&lt;int&gt;();

    public static string FormatAsList&lt;T&gt; (this IEnumerable&lt;T&gt; source, [CanBeNull] string header, Func&lt;T, string&gt; formatElement)
    {
      return FormatAsListInternal(source, header, formatElement);
    }

    public static string FormatAsList (this IEnumerable&lt;string&gt; source, string header = null)
    {
      return FormatAsListInternal(source, header, x =&gt; x);
    }

    private static string FormatAsListInternal&lt;T&gt; (IEnumerable&lt;T&gt; source, [CanBeNull] string header, Func&lt;T, string&gt; formatElement)
    {
      try
      {
        s_indentLevel.Value++;

        var preamble = header == null
            ? &quot;&quot;
            : $&quot;{header}:{Environment.NewLine}&quot;;

        return $&quot;{preamble}{source.ConvertAndJoin(x =&gt; Indent(formatElement(x), s_indentLevel.Value), Environment.NewLine)}&quot;;
      }
      finally
      {
        s_indentLevel.Value--;
      }

      string Indent (string s, int level)
      {
        return new string(&#39; &#39;, level * 2) + &quot;- &quot; + s;
      }
    }
  }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[19,7,19,45,1],[27,7,27,43,1],[35,16,35,24,1],[35,25,35,27,1],[35,28,35,34,1],[36,9,36,22,1],[44,7,44,45,1],[53,7,53,38,1],[53,38,53,39,1],[53,39,53,41,1],[53,7,53,41,1],[54,7,54,33,1],[54,33,54,56,1],[54,56,54,74,1],[54,7,54,74,1],[57,5,57,85,1],[61,7,61,66,1],[66,7,66,56,1],[66,56,66,57,1],[66,57,66,59,1],[66,7,66,59,1],[73,9,73,31,1],[75,9,77,49,1],[79,9,79,56,1],[79,56,79,101,1],[79,101,79,126,1],[79,9,79,126,1],[83,9,83,31,1],[84,7,84,8,1],[88,9,88,54,1],[90,5,90,6,1]]);
    </script>
  </body>
</html>