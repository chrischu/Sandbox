<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Development\SolutionInspector\src\SolutionInspector.Configuration\Validation\ConfigurationValidationException.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Diagnostics.CodeAnalysis;
using System.Runtime.Serialization;
using SolutionInspector.Commons.Attributes;
using SolutionInspector.Commons.Extensions;

namespace SolutionInspector.Configuration.Validation
{
  /// &lt;summary&gt;
  ///   Represents errors that occur when validating a configuration.
  /// &lt;/summary&gt;
  [SuppressMessage(&quot;Microsoft.Usage&quot;, &quot;CA2240:ImplementISerializableCorrectly&quot;)]
  [Serializable]
  public class ConfigurationValidationException : Exception
  {
    /// &lt;summary&gt;
    ///   Creates a new &lt;see cref=&quot;ConfigurationValidationException&quot; /&gt;
    /// &lt;/summary&gt;
    public ConfigurationValidationException (
        IReadOnlyCollection&lt;string&gt; documentValidationErrors,
        IReadOnlyDictionary&lt;string, IReadOnlyCollection&lt;string&gt;&gt; propertyValidationErrors)
        : base(FormatValidationErrorMessage(documentValidationErrors, propertyValidationErrors))
    {
      DocumentValidationErrors = documentValidationErrors;
      PropertyValidationErrors = propertyValidationErrors;
    }

    /// &lt;summary&gt;
    ///   Serialization constructor.
    /// &lt;/summary&gt;
    [ExcludeFromCodeCoverage /* Serialization ctor */]
    // ReSharper disable once NotNullMemberIsNotInitialized
    protected ConfigurationValidationException (SerializationInfo info, StreamingContext context)
        : base(info, context)
    {
    }

    /// &lt;summary&gt;
    ///   All document validation errors.
    /// &lt;/summary&gt;
    public IReadOnlyCollection&lt;string&gt; DocumentValidationErrors { get; }

    /// &lt;summary&gt;
    ///   All property validation errors by property path.
    /// &lt;/summary&gt;
    [PublicApi]
    public IReadOnlyDictionary&lt;string, IReadOnlyCollection&lt;string&gt;&gt; PropertyValidationErrors { get; }

    private static string FormatValidationErrorMessage (
        IReadOnlyCollection&lt;string&gt; documentValidationErrors,
        IReadOnlyDictionary&lt;string, IReadOnlyCollection&lt;string&gt;&gt; propertyValidationErrors)
    {
      var documentMessages = EnumerableExtensions.ConvertAndJoin(documentValidationErrors, s =&gt; $&quot;    - {s}&quot;, Environment.NewLine);
      var documentErrors = $&quot;  - For the document:{Environment.NewLine}{documentMessages}&quot;;

      var propertyErrors = propertyValidationErrors.ConvertAndJoin(
          e =&gt;
          {
            var messages = EnumerableExtensions.ConvertAndJoin(e.Value, s =&gt; $&quot;    - {s}&quot;, Environment.NewLine);
            return $&quot;  - For property &#39;{e.Key}&#39;:{Environment.NewLine}{messages}&quot;;
          },
          Environment.NewLine);

      return $&quot;Validation failed because of the following errors:{Environment.NewLine}{documentErrors}{Environment.NewLine}{propertyErrors}&quot;;
    }
  }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[23,11,23,97,1],[25,7,25,59,1],[26,7,26,59,1],[54,7,54,97,1],[54,97,54,109,1],[54,109,54,132,1],[54,7,54,132,1],[55,7,55,92,1],[57,7,60,13,1],[60,13,60,78,1],[60,78,60,90,1],[60,90,60,113,1],[60,13,60,113,1],[60,113,61,13,1],[61,13,61,82,1],[61,82,63,32,1],[57,7,63,32,1],[65,7,65,142,1]]);
    </script>
  </body>
</html>