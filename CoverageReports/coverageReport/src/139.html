<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Development\SolutionInspector\src\SolutionInspector.DefaultRules\RequiredResourceLanguagesRule.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using JetBrains.Annotations;
using SolutionInspector.Api.ObjectModel;
using SolutionInspector.Api.Rules;
using SolutionInspector.Configuration;
using SolutionInspector.Configuration.Attributes;

namespace SolutionInspector.DefaultRules
{
  /// &lt;summary&gt;
  ///   Checks that all given resource files are localized in all given languages in the project.
  /// &lt;/summary&gt;
  [Description (&quot;Checks that all given resource files are localized in all given languages in the project.&quot;)]
  public class RequiredResourceLanguagesRule : ProjectRule
  {
    /// &lt;summary&gt;
    ///   Comma-separated list of required resources (e.g. &quot;Resources,OtherResources&quot;).
    /// &lt;/summary&gt;
    [CanBeNull]
    [ConfigurationValue]
    [Description (&quot;List of required resources (e.g. &#39;Resources&#39;).&quot;)]
    public CommaSeparatedStringCollection RequiredResources =&gt; GetConfigurationValue&lt;CommaSeparatedStringCollection&gt;();

    /// &lt;summary&gt;
    ///   Comma-separated list of required languages (e.g. &quot;de,pl,hr&quot;).
    /// &lt;/summary&gt;
    [CanBeNull]
    [ConfigurationValue]
    [Description (&quot;List of required languages (e.g. &#39;de&#39;, &#39;pl&#39;).&quot;)]
    public CommaSeparatedStringCollection RequiredLanguages =&gt; GetConfigurationValue&lt;CommaSeparatedStringCollection&gt;();

    /// &lt;inheritdoc /&gt;
    public override IEnumerable&lt;IRuleViolation&gt; Evaluate ([NotNull] IProject target)
    {
      if (RequiredResources != null)
        foreach (var resourceName in RequiredResources)
        {
          var resourceDefaultLanguageFileName = $&quot;{resourceName}.resx&quot;;
          if (target.ProjectItems.All(i =&gt; i.Name != resourceDefaultLanguageFileName))
          {
            yield return
                new RuleViolation(
                  this,
                  target,
                  $&quot;For the required resource &#39;{resourceName}&#39; no default resource file (&#39;{resourceDefaultLanguageFileName}&#39;) could be found.&quot;);
          }

          if (RequiredLanguages != null)
          {
            foreach (var languageName in RequiredLanguages)
            {
              var resourceLanguageFileName = $&quot;{resourceName}.{languageName}.resx&quot;;
              if (target.ProjectItems.All(i =&gt; i.Name != resourceLanguageFileName))
                yield return
                    new RuleViolation(
                      this,
                      target,
                      $&quot;For the required resource &#39;{resourceName}&#39; no resource file for language &#39;{languageName}&#39; &quot; +
                      $&quot;(&#39;{resourceLanguageFileName}&#39;) could be found.&quot;);
            }
          }
        }
    }
  }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[24,64,24,119,1],[32,64,32,119,1],[37,7,37,37,1],[38,18,38,34,1],[38,35,38,37,1],[38,38,38,55,1],[40,11,40,72,1],[41,11,41,44,1],[41,44,41,85,1],[41,85,41,87,1],[41,11,41,87,1],[43,13,47,145,1],[50,11,50,41,1],[52,22,52,38,1],[52,39,52,41,1],[52,42,52,59,1],[54,15,54,84,1],[55,15,55,48,1],[55,48,55,82,1],[55,82,55,84,1],[55,15,55,84,1],[56,17,61,74,1],[64,9,64,10,1],[65,5,65,6,1]]);
    </script>
  </body>
</html>