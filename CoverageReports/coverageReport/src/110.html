<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Development\SolutionInspector\src\SolutionInspector\Rules\RuleCollectionBuilder.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using SolutionInspector.Api.Configuration.Ruleset;
using SolutionInspector.Api.Rules;

namespace SolutionInspector.Rules
{
  internal interface IRuleCollectionBuilder
  {
    IRuleCollection Build (IRulesetConfiguration ruleset);
  }

  internal class RuleCollectionBuilder : IRuleCollectionBuilder
  {
    public IRuleCollection Build (IRulesetConfiguration ruleset)
    {
      var solutionRules = BuildSolutionRules(ruleset.SolutionRules);
      var projectRules = BuildProjectRules(ruleset.ProjectRuleGroups);
      var projectItemRules = BuildProjectItemRules(ruleset.ProjectItemRuleGroups);

      return new RuleCollection(solutionRules, projectRules, projectItemRules);
    }

    private IEnumerable&lt;ISolutionRule&gt; BuildSolutionRules (IReadOnlyCollection&lt;ISolutionRule&gt; solutionRulesConfiguration)
    {
      return solutionRulesConfiguration;
    }

    private IEnumerable&lt;IProjectRule&gt; BuildProjectRules (IReadOnlyCollection&lt;IProjectRuleGroupConfiguration&gt; projectRuleGroups)
    {
      foreach (var projectRuleGroup in projectRuleGroups)
      foreach (var projectRule in projectRuleGroup.Rules)
        yield return new FilteringProjectRuleProxy(projectRuleGroup.AppliesTo, projectRule);
    }

    private IEnumerable&lt;IProjectItemRule&gt; BuildProjectItemRules (IReadOnlyCollection&lt;IProjectItemRuleGroupConfiguration&gt; projectItemRuleGrousp)
    {
      foreach (var projectItemRuleGroup in projectItemRuleGrousp)
      foreach (var projectItemRule in projectItemRuleGroup.Rules)
        yield return new FilteringProjectItemRuleProxy(projectItemRuleGroup.AppliesTo, projectItemRuleGroup.InProject, projectItemRule);
    }
  }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[17,7,17,69,1],[18,7,18,71,1],[19,7,19,83,1],[21,7,21,80,1],[26,7,26,41,1],[31,16,31,36,1],[31,37,31,39,1],[31,40,31,57,1],[32,16,32,31,1],[32,32,32,34,1],[32,35,32,57,1],[33,9,33,93,1],[34,5,34,6,1],[38,16,38,40,1],[38,41,38,43,1],[38,44,38,65,1],[39,16,39,35,1],[39,36,39,38,1],[39,39,39,65,1],[40,9,40,137,1],[41,5,41,6,1]]);
    </script>
  </body>
</html>